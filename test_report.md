# HDF5 Compression Test Report

## Test Information

## Test Results（release 版本得到的测试结果）

| Filter  | Parameters | Level | Ratio | Comp Time (ms) | Decomp Time (ms) | Size      | Original Size |
| ------- | ---------- | ----- | ----- | -------------- | ---------------- | --------- | ------------- |
| None    |            | 0     | 1.00  | 0              | 0                | 166.21 MB | 166.21 MB     |
| GZIP    |            | 1     | 1.55  | 19392          | 68               | 210.21 MB | 325.46 MB     |
| GZIP    |            | 6     | 1.60  | 30714          | 59               | 203.03 MB | 325.46 MB     |
| GZIP    |            | 9     | 1.60  | 30238          | 68               | 202.99 MB | 325.46 MB     |
| ZSTD    |            | 1     | 1.60  | 17420          | 165              | 203.73 MB | 325.46 MB     |
| ZSTD    |            | 6     | 1.70  | 44714          | 146              | 191.49 MB | 325.46 MB     |
| ZSTD    |            | 9     | 1.62  | 80017          | 121              | 200.75 MB | 325.46 MB     |
| BLOSC   |            | 1     | 1.78  | 18256          | 137              | 183.15 MB | 325.46 MB     |
| BLOSC   |            | 6     | 1.83  | 22530          | 132              | 177.79 MB | 325.46 MB     |
| BLOSC   |            | 9     | 1.85  | 40789          | 151              | 175.58 MB | 325.46 MB     |
| VBZ     |            | 1     | 2.31  | 18175          | 157              | 141.07 MB | 325.46 MB     |
| VBZ     |            | 6     | 2.31  | 18797          | 134              | 140.68 MB | 325.46 MB     |
| VBZ     |            | 9     | 2.31  | 18509          | 136              | 140.80 MB | 325.46 MB     |
| SHUFFLE |            | 1     | 1.00  | 15071          | 131              | 325.46 MB | 325.46 MB     |
| SHUFFLE |            | 6     | 1.00  | 17395          | 177              | 325.46 MB | 325.46 MB     |
| SHUFFLE |            | 9     | 1.00  | 19874          | 208              | 325.46 MB | 325.46 MB     |
| SZIP    |            | 1     | 1.00  | 16880          | 166              | 325.46 MB | 325.46 MB     |
| SZIP    |            | 6     | 1.00  | 16597          | 153              | 325.46 MB | 325.46 MB     |
| SZIP    |            | 9     | 1.00  | 20143          | 149              | 325.46 MB | 325.46 MB     |

## Analysis

1. VBZ 压缩能力最佳，可达到 2.31 倍压缩率，而且压缩时间也不会太长
2. 固定过滤器插件类型，调整压缩别时，压缩率变化不大；可能和压缩参数有关，需要进一步确认
3. VBZ 还是没有达到源数据的水平，调整参数应该还有提升空间
4. 调整了一下压缩比例的计算公式：压缩率 = 压缩后 dataset 大小 / 压缩前 dataset 大小，应该对结果影响不大（Size 和 Original Size 都是 dataset 的大小）
5. 压缩时间受多个因素影响，如 ssd 还是机械硬盘，剩余空间是否有碎片，运行环境（wsl+docker）压缩参数、压缩实现逻辑等，因此压缩时间可能存在误差；此外压缩时间是否合理可能后续可以和 repack 进行对比确认，做进一步优化
6. BLOC2 和 LZ4 需要修改插件版本，目前使用 1.10.11 版本不支持，需要修改 dockerfile，时间上比较紧急，后续有时间再进行测试

## Result

初步结论：VBZ 比较好，但是还需要进一步确认
